<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accessories</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        body{
            margin:0;
            padding:0;
            background-color: #6C7A89;
        }
        .navbar .navbar-nav .nav-link:hover{
            background-color: #A9A9A9;
            
        }
        h3{
            text-align: center;
            color:white
        }
        .error{
position: absolute;
top: -110%; left: 31%;
padding: 1% 20%;
border-radius: 3px;
background-color: #FDCAC4;
color: #ED6160;
display: none;

}
.error::before{

content: "";

width: 0;

height: 0;

border-left: 9px solid transparent;

border-right: 9px solid transparent;
border-top: 9px solid #FDCAC4;

position: absolute;

bottom: -21%; left: 10%;

}
.error:nth-child(2){

top: 70px;

background-color: #D9F0FD;

}



.error:nth-child(2)::before{

border-top: 9px solid #D9F0FD;

}



.error:nth-child(3){

top: 140px;

padding: 1% 18%;

background-color: #6DFFA7;

}
.error:nth-child(3)::before{

border-top: 9px solid #6DFFA7;

}
.error:nth-child(4){

top: 210px;

background-color: #ffd866;
}
.error:nth-child(4)::before{
border-top: 9px solid #ffd866;

}
    </style> 
    </head>
    <body>

        <nav class="navbar navbar-expand-lg shadow-sm navbar-light bg-white fixed-top" >
            <a class="navbar-brand" href="#">
                <img src="qyrus.png" width="100px">
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav ml-auto">
                <li class="nav-item ">
                  <a class="nav-link text-body" href="server.html">Server</a>
                </li>
                <li class="nav-item ">
                  <a class="nav-link text-body" href="mobiles.html">Mobiles</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-body" href="accessories.html">Accessories</a>
                </li>      
              </ul>
            </div>
          </nav>
          <br>
          <br>
          
        <div class="container mt-4 p-2">
        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h4 class="text-center">Add Accessories</h4>
                    </div>
                    <div class="card-body">
                        
                <div class="form-group" >
                    <label for="currentclient">Enter Current Client</label>
                    <input type="text" class="form-control" placeholder="enter client" id="currentclient" required>
                    
                </div> 
                <div class="form-group">
                    <label for="">Date of Purchase</label>
                    <input type="date" class="form-control" placeholder="YYYY-MM-DD" id="dateofpurchase" required>
                   
                </div> 
                <div class="form-group">
                    <label for="">Enter location</label>
                    <select name="location" class="form-control" placeholder="enter location" id="location" required>
                        <option value="UK">UK</option>
                        <option value="India">India</option>
                         <option value="Mumbai">USA</option>
                         
                    </select>
                  
                </div>      
                <div class="form-group">
                    <label for="">Enter Manufacturer</label>
                    <input type="text" class="form-control" placeholder="enter Manufacturer" id="manufacturer" required>
                    
                </div> 
                <div class="form-group">
                    <label for="">Enter Model</label>
                    <input type="text" class="form-control" placeholder="enter Model" id="model" required>
                    
                </div>   
                <div class="form-group">
                    <label for="">Enter os</label>
                    <input type="text" class="form-control" placeholder="enter os" id="os" required>
                    
                </div>        
                <div class="form-group">
                    <label for="">Enter SerielNumber</label>
                    <input type="text" class="form-control" placeholder="enter serielnumber" id="serielnumber" maxlength="10" required>
                    
                </div>  
                <div class="form-group">
                    <label for="">Enter status</label>
                    <select name="status" class="form-control" placeholder="enter status" id="status" required>
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                         <option value="damaged">Damaged</option>
                    </select>
                </div>   
                <div class="form-group">
                    <label for="">Enter Type Of Device</label>
                    <input type="text" class="form-control" placeholder="Enter type" id="typeofdevice">
                </div>  
                
                <div class="mt-3">
                    <button class="btn btn-primary float-right" onclick="submitForm()">Submit</button>
                </div>
              
                
                <!--<div class="alert alert-success">
                    <span id="message">hiii</span>
                </div>-->
            </div>
        </div>
            
    </div>
            <div class="col-md-4">
                <h3 class="fs-4 mb-3">Existing Accessories</h3>
                    <input class="form-control" id="myInput" type="text" placeholder="Search..">
                    <br>
                    <table class="table bg-white rounded shadow-sm table-hover ">
                    
                    <thead>
                        <tr>
                        <th scope = "col">DeviceId</th>
                        <th scope = "col">CurrentClient</th>
                        <th scope = "col">DateofPurchase</th>
                        <th scope = "col">Location</th>
                        <th scope = "col">Manufacturer</th>
                        <th scope = "col">Model</th>
                        <th scope = "col">OS</th>
                        <th scope = "col">SerielNumber</th>
                        <th scope = "col">Status</th>
                        <th scope = "col">TypeofDevice</th>
                        <th scope = "col">Edit</th>
                        <th scope = "col">Delete</th>
                        </tr>
                    </thead>
                    <tbody id="tbData">

                    </tbody>
                </table>

            </div>

            </div>
        </div>
        <script>

            
$(document).ready(function(){
  $("#myInput").on("keyup", function() {
    var value = $(this).val().toUpperCase();
    $("#tbData tr").filter(function() {
      $(this).toggle($(this).text().toUpperCase().indexOf(value) > -1)
    });
  });
});
            var editFormData;
            function getFormData(){
                return{
                    currentclient:document.getElementById("currentclient").value,
                    dateofpurchase:document.getElementById("dateofpurchase").value,
                    location:document.getElementById("location").value,
                    manufacturer:document.getElementById("manufacturer").value,
                    model:document.getElementById("model").value,
                    os:document.getElementById("os").value,
                    serielnumber:document.getElementById("serielnumber").value,
                    status:document.getElementById("status").value,
                    typeofdevice:document.getElementById("typeofdevice").value
                }
            }

            function clearFormData(){
                document.getElementById("currentclient").value="";
                    document.getElementById("dateofpurchase").value="";
                    document.getElementById("location").value="";
                    document.getElementById("manufacturer").value="";
                    document.getElementById("model").value="";
                    document.getElementById("os").value="";
                    document.getElementById("serielnumber").value="";
                    document.getElementById("status").value="";
                    document.getElementById("typeofdevice").value="";

            }
            function setFormData(currentclient,dateofpurchase,location,manufacturer,model,os,serielnumber,status,typeofdevice){
                document.getElementById("currentclient").value=currentclient;
                    document.getElementById("dateofpurchase").value=dateofpurchase;
                    document.getElementById("location").value=location;
                    document.getElementById("manufacturer").value=manufacturer;
                    document.getElementById("model").value=model;
                    document.getElementById("os").value=os;
                    document.getElementById("serielnumber").value=serielnumber;
                    document.getElementById("status").value=status;
                    document.getElementById("typeofdevice").value=typeofdevice;


            }
            function editDataCall(id){
                console.log(id)
                fetch("http://localhost:8080/api/getaccessories?id="+id,{
                    method:"GET",
                }).then((res)=>res.json()).then((response)=>{
                    console.log(id)
                    console.log("Edit info",response)
                    for(i=0;i<response.length;i++){
                        // console.log("control inside forloop", response[i])
                        // console.log()
                        if(response[i].id == id) {
                            editFormData = response[i];
                        }
                        
                    }
                    
                    setFormData(editFormData.currentclient,editFormData.dateofpurchase,editFormData.location,editFormData.manufacturer,editFormData.model,editFormData.os,editFormData.serielnumber,editFormData.status,editFormData.typeofdevice)
                })
            }
            function submitForm(){
                if(!editFormData) addUser();
                else editData();
            }

    //function setSuccessMessage(message) {
    //document.getElementById("message").innerHTML = message;

//}
          function addUser(){
            let payload = getFormData();
            
            /*payload['currentclient']=document.getElementById("currentclient").value;
            payload['dateofpurchase']=document.getElementById("dateofpurchase").value;
            payload['location']=document.getElementById("location").value;
            payload['manufacturer']=document.getElementById("manufacturer").value;
            payload['model']=document.getElementById("model").value;
            payload['os']=document.getElementById("os").value;
            payload['serielnumber']=document.getElementById("serielnumber").value;
            payload['status']=document.getElementById("status").value;
            payload['typeofdevice']=document.getElementById("typeofdevice").value;*/

            fetch("http://localhost:8080/api/addaccessories",{
                method:"POST",
                mode:"cors",
                headers:{
                    "Content-Type":"application/json"
                },
                body:JSON.stringify(payload)
            }).then((res)=>res.json()).then((response)=>{
                //setSuccessMessage(response.message)
                //document.getElementById("message").innerHTML = response.message
                /*document.getElementById("currentclient").value = "";
                document.getElementById("dateofpurchase").value="";
                document.getElementById("location").value="";
                document.getElementById("manufacturer").value="";
                document.getElementById("model").value="";
                document.getElementById("os").value="";
                document.getElementById("serielnumber").value="";
                document.getElementById("status").value="";
                document.getElementById("typeofdevice").value="";*/
clearFormData();

                getData();
            })
            

          } 

          function editData(){
            var formData=getFormData();
            formData['id'] = editFormData.id;
            fetch("http://localhost:8080/api/updateaccessories?id="+ formData['id'],{
                method:"PUT",
                mode:"cors",
                headers:{
                    "Content-Type":"application/json"
                },
                body:JSON.stringify(formData)
            }).then((res)=>res.json()).then((response)=>{
                //setSuccessMessage(response.message)
                clearFormData();
                getData();

            })

          }

            function getData(){
                fetch("http://localhost:8080/api/getaccessories").then(
                    (res)=>res.json()
                ).then((response)=>{
                    var tmpData="";
                    console.log(response);
                    Array.from(response).forEach(element => {
                        tmpData+="<tr>"
                        tmpData+="<td>"+element.id+"</td>";
                        tmpData+="<td>"+element.currentclient+"</td>";
                        tmpData+="<td>"+element.dateofpurchase+"</td>";
                        tmpData+="<td>"+element.location+"</td>";
                        tmpData+="<td>"+element.manufacturer+"</td>";
                        tmpData+="<td>"+element.model+"</td>";
                        tmpData+="<td>"+element.os+"</td>";
                        tmpData+="<td>"+element.serielnumber+"</td>";
                        tmpData+="<td>"+element.status+"</td>";
                        tmpData+="<td>"+element.typeofdevice+"</td>";
                        
                        tmpData+="<td><button class='btn btn-primary' onclick='editDataCall(`"+element.id+"`)'>Edit</button></td>";
                        tmpData+="<td><button class='btn btn-danger' onclick='deleteData(`"+element.id+"`)'>Delete</button></td>";
                       
                        tmpData+="</tr>";

                    });
                    document.getElementById("tbData").innerHTML=tmpData;
                })
            }
            getData();

            function deleteData(id){
                fetch("http://localhost:8080/api/deleteaccessories/"+id,{
                    method:"DELETE",
                }).then((res)=>res.json()).then(
                    (response)=>{
                        //setSuccessMessage(response.message);
                        getData();
                    }
                )
            }
           

           // function myFunction() {
  //alert("Deleted Successfully !");
//}

//function myfunction2() {
  //alert(" Successfully Done!");
//}
        </script>
    </body>
</html>